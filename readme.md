## Документация по веб-сервису прогноза погоды (Flask)

Этот веб-сервис на Flask предоставляет прогноз погоды для маршрута между двумя городами, а также подробную информацию о погоде в отдельных городах. Сервис взаимодействует с внешним API для получения данных о погоде на основе названий городов и координат.

### Эндпоинты

#### 1. `GET /` - Проверка погоды на маршруте

Этот эндпоинт отображает главную страницу, где пользователи могут ввести два города (начальный и конечный) для проверки прогноза погоды по маршруту.

- **Методы**: `GET`, `POST`
- **Параметры запроса** (POST):
  - `start_city`: Название начального города.
  - `end_city`: Название конечного города.

- **Ответ**:
  - Если города валидны, отображается шаблон `route_weather_results.html` с данными:
    - `start_city`: Название начального города.
    - `end_city`: Название конечного города.
    - `start_condition`: Погодные условия для начальной точки (хорошие/неблагоприятные).
    - `end_condition`: Погодные условия для конечной точки (хорошие/неблагоприятные).

- **Обработка ошибок**:
  - Если не удается получить координаты или данные о погоде, выводится сообщение об ошибке, и пользователь перенаправляется на форму.
  - Пример сообщения: `"Не удалось найти координаты для указанных городов."`

#### 2. `POST /check_route_weather` - AJAX Проверка погоды на маршруте

Этот эндпоинт проверяет погодные условия по маршруту между двумя городами через AJAX и возвращает данные в формате JSON.

- **Метод**: `POST`
- **Тело запроса** (JSON):
  - `start_city`: Название начального города.
  - `end_city`: Название конечного города.

- **Ответ**:
  - JSON объект, содержащий:
    - `start_city`: Название начального города.
    - `start_weather_condition`: Погодные условия для начальной точки (хорошие/неблагоприятные).
    - `end_city`: Название конечного города.
    - `end_weather_condition`: Погодные условия для конечной точки (хорошие/неблагоприятные).

- **Обработка ошибок**:
  - 400, если не указаны оба города.
  - 500, если не удалось получить координаты или данные о погоде.

#### 3. `GET /get_weather` - Прогноз погоды для города

Этот эндпоинт предоставляет прогноз погоды и текущую температуру для конкретного города.

- **Метод**: `GET`
- **Параметры запроса**:
  - `city`: Название города для получения прогноза (по умолчанию: `Москва`).

- **Ответ**:
  - Отображается шаблон `get_weather.html`, содержащий:
    - `city`: Название города.
    - `current_temperature`: Текущая температура в градусах Цельсия.
    - `temperature_max`: Максимальная прогнозируемая температура в градусах Цельсия.
    - `temperature_min`: Минимальная прогнозируемая температура в градусах Цельсия.
    - `wind_speed`: Скорость ветра в км/ч.
    - `precipitation_probability`: Вероятность осадков в процентах.
    - `precipitation_intensity`: Интенсивность осадков (перевод).
    - `precipitation_type`: Тип осадков (перевод).
    - `weather_condition`: Общие погодные условия (хорошие/неблагоприятные).
    - `translated_weather`: Переведенное описание погодных условий.

- **Обработка ошибок**:
  - 500, если не удалось получить координаты, ключ местоположения или данные о погоде.
  - Пример ошибки: `{"error": "Не удалось получить текущие данные о погоде."}`

### Ключевые вспомогательные функции

#### `get_coordinates_by_city(city_name)`
- Получает координаты (широту и долготу) города на основе его названия.

#### `get_location_key(lat, lon)`
- Получает ключ местоположения для города на основе его широты и долготы.

#### `get_weather_by_location(lat, lon)`
- Получает прогноз погоды на основе координат местоположения.

#### `get_current_weather(location_key)`
- Получает текущие данные о погоде на основе ключа местоположения.

#### `translate_weather(icon_phrase)`
- Переводит погодные фразы с английского на русский язык. Если перевода нет, возвращает оригинальную фразу.

#### `check_bad_weather(temp, wind_speed, precip_prob, precip_intensity)`
- Определяет, являются ли погодные условия "хорошими" или "неблагоприятными" на основе температуры, скорости ветра и вероятности осадков.

### Обработка ошибок и сообщения

- Обработаны ошибки HTTP-статусов 404, 500 и 503. Страницы отображают понятные сообщения пользователю в тёмной теме.
